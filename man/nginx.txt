Обратный прокси-сервер

Ассинхронная обработка запросов
Пересылает данные к другим серверным службам php-fpm
Хорошо показывает себя там где есть статика, потому что он обрабатывает ее
сам.

Init скрипты для разных систем на гитхабе
Перезаписать все параметры по умолчанию можно в /etc/default/nginx

Обновление версии без остановки
nginx -V 
Ставим пак и запускаем service nginx reload для перегрузки мастер процесса

##########################
Configuration

Сontext - зона видимости, блок
Directive - параметр

types - указываем тип данных, если все отображается текстом
include mime.type 

location - блоки для обработки вложенный блоков

Логи /var/log/nginx
error_log - раскидываем логи по папкам


Дерективы:
корень дерективы определяет вложенные

try_files $uri index.html =404 - как обрабатывать запросы, пойти туда-сюда или
выдать ошибку

fastcgi_pass - указывает куда перадавать запросы Php

worker-process auto - указываем количество процесо на ядрах
worker-connection - количество одновременно держащих соедининени (ulimit -n)

Настриваем буфер, время хранения подключений
keapalived_tymeout - время ответа
timeout 10 - врямя обработки запроса

Динамические модули
load_module: - подключаем модули

_______________________________
Features

Expires Headers - уменьшают время загрузки, указывает браузеру загружать
даннные из кэша. Для лого, css и тп.

Gzip - уменьшить размер ответов
gzip on
gzip_min_length - минимальный размер файла для сжатия
gzip_compression_level - 
gzip_types - какие файлы сжимать
gzip_disable - в каких браузерах отключить

Бэнч марк сервера, без учета скорости передачи данных
ab - apache banchamark
Увеличение скорости в 100 раз

ab -n 100 -с http://local.name
Настраиваем кэширование на сервера
fastcgi_cache_path: /tmp
fastcgi_cache_key - формат кэша
fastcgi_cache_valid - время жизни кэша

Добавить заголовок чтобы различать ответы из кэша
add_header


Лимиты запросов на сервер
Сoncurrency - паралельные соединения от одного пользоывателя
frequency - количество одновременных подключений

Стриминг видео
mp4
mp4_buffer_size 


Geoip - узнаем положение клиента, которое можно в дальнейшем использовать
geoip_country
geoip_city


HTTP2
Бинарный протокол - в отличие от текстового
Сжатие заголовков, постоянные соединение, мултиплексирование, push server
Получая index.html браузер устанавливает соединение с сервером и через тоже
соединение получает необходимые файлы
Push server - отправляет все файлы сразу которые необходимы для подключения
Используется только с https

HTTP1 - одно соединение - один файл. 

SSL
listen 443 ssl;
ssl_certificate
ssl_certificate_key


auth_basic - настроить аутентификацию
Настраиваем htpaswd файл из apache

_______________

Обратный прокси
proxy_path - куда перейти в данном 

Создаем балансировку
upstream name{
	one
	two
	free
}



