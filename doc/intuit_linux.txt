	---- 1.СЕАНС РАБОТЫ-----

UID - уникальное числовое значение учетной записи (аккаунта) присваиваемое системой. Которое имеет свое разграничение.
От 1 до 100 - присваивается псевдо учетным записям.
GID - уникальное число для групп. Пользователь должен состоять хотя бы в одной группе.
По умолчанию это группа имеет тоже название что и аккаунт и имеет такое же значение идентификатора.
При создании аккаунта указывается так же полное имя пользователя, домашний каталог, а также командная оболочка.
Командный интерпретатор - программа служащая для взаимодействия между пользователем и системой. 
          имеет следующие функции 
	  - ввод команд и просмотр статуса системы.
          - высокоуровневая среда разработки системно-ориентированного кода
               
	       	passwd -  изменить пароль для аккаунта
               	autologin - программа позволяющая автоматически авторизовываться в системе.


Многопользовательская и многозадачная система позволяет организовать лучше параллельное выполнение задач.

Виртуальная консоль - концепция позволяющая параллельно работать с системой из разных консолей. По умолчанию доступно 6 таких консолей.
Alt+F12 - переключение на консоль используемую для выведения системных сообщений.
      		getty - программа отвечающая за запуск виртуальных консолей.
                whoami - позволяет посмотреть текущую учетную запись
                who - отображет зарегистрированных пользователей и др. информацию.
                logout - позволяет завершить текущий сеанс, к аналогичным последствиям приводит нажатие клавиш ctrl+D.
Интересная концепция представления КС, как некого текстового файла от куда происходит считывание системой команд.

________________________________________________

	----- 2. ТЕРМИНАЛ И КОМАНДНАЯ СТРОКА---

Следует отличать от друг от друга три понятия.
   ТЕРМИНАЛ - это точка входа в систему, которая используется для взаимодействия с ЭВМ.
   ВИРТУАЛЬНАЯ КОНСОЛЬ- это программная реализация терминала
   КОМАНДНАЯ СТРОКА - составлящая виртуальной консоли, в которой реализован механизм управления пк пользователем.
		cat - позволяет выводить текст на экран пк.
		echo - выводит последующий текст на экран, может использоваться для перенаправления его в файл.
		type - показывает расположение программы, ее встроенность в систему.
		who - показывает зарегистрированных полозователей в системе.

Три вида справок в системе:

		man,info - выводят подробную информацию по элементу;
     		apropos - показывает где в системе встречается данный элемент;
     		whatis - получение краткой информации;


____________________________________________________


	----- 3. ФАЙЛОВАЯ СИСТЕМА И ЕЕ СТРУКТУРА--------

ФАЙЛ - поименованная и законченная область данных
Все устройства в системе linux представляют из себя файлы

Файловая система - способ хранения и организации доступа к данным на носителе информации.
Имя файла ограничено 256 символами и не может содержать /

Вопрос кодировки, каждый символ в системе представляет из себя один байт.
А следовательно его значение ограниченно 256. Первые 128 символов представляют из себя
латиницу с цифрами и часто употребляемыми символами, а за интерпритацию остальных 128 значений отвечает кодировка установленная в системе. 
В данное время развивается кодировка unicode которая может иметь размер символа больше байта.

Расширение в linux не представляет собой жестких ограничений, файл может иметь расширение,
а может и не иметь. Но все же в системе присутствует своего рода оговоренность.
		files - команда позволяющая определить к чему относится файл.
               /bin - содержит в себе исполняемые  системные файлы
               /boot - здесь содержаться файлы необходымые для загрузки системы, в том числе ядро.
               /dev - хрянятся файлы-дырки, файл-устройства.
               /etc - каталог конфигурационных файлов
               /home - хранятся домашние каталоги
               /lib - содержатся системные библиотеки
               /mnt - каталог для монтирования
               /proc - здесь содержатся, виртуальные файлы работающие с ОП, Здесь содержится информация о запущенных системах.
               /root - домашний каталог администратора
               /sbin - каталог важнейших системных утилит
               /tmp - каталог временных файлов
               /usr - здесь хранятся свои разделы /bin /lib /etc, которые заточены под прикладные программы.
               /var - (varible) - здесь хранятся значения, которые могут понадобится при работе системы.

То, что было перечисленно выше носит названия fhs или file hierarchy standart.

_________________________________________________________

	----- 4. РАБОТА С ФАЙЛОВОЙ СИСТЕМОЙ-------

Концепция текущего каталога, каждая программа работает в первую очередь в рамках текущего каталога.
		PWD - позволяет узнать текущий каталог

Относительный путь начинается с текущего каталога, абсолютный с корневого
	./ - задает как раз относительный путь
После регистрации в системе пользователь в первую очередь оказывается в своем домашнем каталоге.
	~ - указывает на домашний каталог
		MV - перемещение файлов
		CP - позволяет организовать копирование
ЖЕСТКАЯ ССЫЛКА - это (одно из имен файла!) данные которые на прямую в файловой системе указывают на файл.
ИНДЕКСНЫЙ ДЕСКРИПТОР (inode) - свойства файла, в котором содержатся дата создания, права доступа, тип файла и тп.
узнать можно с помощью ls -i представляет из себя уникальное число присвоенное системой.

Все операции в системе проиходят с идексными дескрипторами.

Файл в ФС представляет из себя имя файла и файловый дескриптор содержащий инфорцию о файле и указывающий на область данных
Т.е жесткие ссылки как-то регистрируются в системе. 

СИМВОЛЬНЫЕ ССЫЛКИ - представляющие из себя, файл в котором содержится указания на другой. 
		LN -s - позволяет создать ссылку
		REALPATH позволяет усмотреть к чему в действительности относится ссылка.

Удаление файла происходить только тогда, когда были удалены на него все жесткие ссылки.
		RM - удаление файла, каталог удалить нельзя 
		RM -RF - позволяет удалять каталоги с вложением, а ключ f позволяет подавлять запросы безопасности системы
		RMDIR  - удаляет пустой каталог
____________________________________________________________

	---- 5.ДОСТУП ПРОЦЕССОВ К ФАЙЛАМ И КАТАЛОГАМ---

getty передает имя и пароль программе login, при успешной регистрации управление системой передается командному интерпритатору.
Процесс - выполняющаяся программа.
PID - уникальный номер процесса. PPID - указывает на родительский PID
Доступ к информации для процессов определяется c помощью идентификатора пользователя и идентификатора группы который присвоен каждому процессу.
exec() - команда которая подменяет один процесс на другой.
fork() - системный вызов позволяющий порождать дочерний процесс. Так называемая вилка, позволяющая создать дочерний процесс
Паралелизм в выполнении программ зависит от количества ядер. Если в системе
парелельных потоков вычисления больше чем ядер, значит система работает в псевдопаралельном режиме.
		FG - переводит процесс из фонового режима.
		& - позволяет запустить процесс в фоновом режиме.
		BG - позволяет последний остановленный процесс вновь отправить на исполнение.

		PS - позволяет просматривать запущенные процессы
          		f- отображает запущенные файлы
          		h - графическое отображение иерархии.
!# /bin/bash - строчка указывающая в сценарном файле на интерпритатор
		chmod rwx file - позволяет задавать права доступа для объекта системы.
По умолчанию создается каталог доступный для чтения, записи и запуска.
		cd без ключа перемещает пользователя в домашний каталог

__________________________________________________________________


	---- 6.ПРАВА ДОСТУПА----

Каждый пользователь имеет свой идентификатор uid от которого запускаются

процесс, каждый процесс обязательно имеет идентификатор.
UID наследуется при старте login процедурой exec или fork-порождением.

id - позволяет просмотреть свойства пользователя
_____________________________________________________
Группа по умолчанию это группа с пользовательским именем. Пользователь должен
состоять хотябы в одной группе, т.к это подразумевается синтаксисом
/etc/passwd. Группа по умолчанию не обязательно должна носить имя
пользователя.

/etc/group - хранит информацию о группах
_____________________________________________________

Ярлык файла хранит информацию о владельце, группе и атрибутах доступа и др.
Каждый каталог имеет как минимум две жестких ссылки mnt | mnt/. При создании
подкаталога это значение увеличивается.
___________________________________________

ФС /proc - используется в процессе выполнение ps.

Если есть доступ в папке то можно удалить файл к которому нет доступа.

rm -i позволяет удалять файлы со сложными именами.

t бит в атрибутах для посторонних в каталоге запрещает удалять чужие файлы.
Так реализуется ОБЩИЙ ДОСТУП К КАТАЛОГУ.
T - указывает на то, что не используется бит x.

Возможно в своем каталоге сменить владельца файла, не прибегая с chown.
Используя для этого перемещение, переименование.
__________________________________________________

Подмена идентификатора

Пользователь может изменить uid если запустит exec отрабатывающую программу из
файла с атрибутом SetUID. (s) который отображается в атрибутах владельца.
/bin/passwd - пример
Файлы с таким битом доступны пользователю только на выполнение.

Может использоваться подобная связка бита и группы shadow
_______________________________________________________


	---7.РАБОТА С ТЕКСТОВЫМИ ДАННЫМИ----

		hexdump -C - просмотр 16-го кода
		strings - вывод строк файла, на случай исполняемого кода
Когда процесс открывает файл он получает его дескриптор. Первый открытый файл
будет иметь дескриптор 0, 1 и тд.
Работа с дескриптором, как с потоком данных.

Каждый процесс при старте получает три файла, а следовательно три дескриптора
отвечающие за:
0 - чтение - стандартный ввод
1 - запись - стандартный вывод
2 - диагностические сообщения (стандартный вывод ошибок)
А следовательно первый открытый процессом файл будет иметь дескриптор 3.

ДЕСКРИПТОР - это описатель потока данных открытого процессом.

Дочерний процесс наследует все дескрипторы родительского

1> - стандартный вывод
2> - вывод ошибок
2>&1 - все вместе

	/dev/null - специальный файл дырка в который можно выбросить ненужный
	поток

Конвейер - когда одна команда передает данные со своего выхода на вход в
другой. Для этого используется символ | 

Канал (pipe) - связь между дескприпторами двух файлов где данные с одного
конца тут же поступают на другой.

Фильтры - обрабатывают поток данных и выдают результат. cat, less

Часто встречаемый набор утилит и фильтров который есть в каждом дистрибьютиве
линукса называется coreutils.

Работа с linux есть работа с текстом.
	Строки - основная величина передаваемая в терминал
	Поля - объекты между разделителями
	Символы - один знак
^J - cимвол перевода строки
^M - возврат коретки (но в консоли делает одно и тоже)

	. указывает на текущий каталог
	find . | wc -l - вывести количество файлов в текущем каталоге
	тк поиск формирует список, а -l отвечает за подсчет строк.
find /etc  -maxdepth 0 -group root - поиск по группе, с максимальным
углублением не дальше текущей папки.

	find /etc  -maxdepth 1 -group root | cut -d / -f 3 > search.txt
	Перенаправить обработанный ввод в файл 
		-d указывает на разделитель
		-f какое поле выводить
		\ - символ который позволяет на перейти на новую строку
			при наборе команды
		grep - фильтр который выводит строки содержащие указанный
		объект
		grep -v [name] - исключит и списка содержащий объект строки

Регулярные выражения - возможность выразить формулой необходимый поиск.
		tr - позволяет производить замену символов (B Б)
		мощная штука может заменить пробелы или ненужные символы
		sed - может организовать замену символов

___________________________________________________________________

[methody@localhost methody]$ cat grep.info | tr "[:upper:]" "[:lower:]" | tr
"[:space:][:punct:]" "\n" \
> | sort | uniq -c | sort -nr | head -8
 15233
 720 the
 342 of
 251 to
 244 a
 213 and
 180 or
 180 is
 [methody@localhost methody]$

	       Пример 7.16. Получение упорядоченного по частотности списка
	       словоупотреблений

	       Мефодий (вернее, компьютер по плану Мефодия) подсчитал, сколько
	       раз какие слова были употреблены в файле " grep.info " и вывел
	       несколько самых частоупотребляемых с указанием количества
	       употреблений в файле. Для этого потребовалось сначала заменить
	       все большие буквы маленькими, чтобы не было разных способов
	       написания одного слова, затем заменить все пробелы и знаки
	       препинания концом строки ( символ " \n "), чтобы в каждой
	       строке было ровно по одному слову (Мефодий всюду взял параметры
	       tr в кавычки, чтобы bash не понял их неправильно). Потом список
	       был отсортирован, все повторяющиеся слова заменены одним словом
	       с указанием количества повторений (" uniq -c "), затем строки
	       снова отсортированы по убыванию чисел в начале строки (" sort
	       -nr ") и выведены первые 8 строк (" head -8 ").
	
____________________________________________________________________________


	---7. ВОЗМОЖНОСТИ КОМАНДНОЙ ОБОЛОЧКИ---

		stty -a - показывает настройки терминальной линии
	Ctrl+S +Q - позволяют приостановить выдачу текста на консоль

		reset - перегружает консоль
		stty sane - сбрасывает настройки консоли
	Ctrl+R - его повторное нажатие позволяет листать историю

bash_history обновляется только после завершения оболочки.
и хранит не более 500 команд.



		alias - создание сокращений команд
		unalias - удаляет сокращения
		pushd - устанавливает каталог
		popd - использует установленный каталог

Достраивание (сompletion) - позволяет автоматизировать ввод.

Шаблон - спец строка для установления ввода.
	[] - позволяет найти только один	pushd - устанавливает каталог
	popd - использует установленный каталог
	Достраивание (сompletion) - позволяет автоматизировать ввод.
	
	Шаблон - спец строка для установления ввода.
		[] - позволяет найти только определенный символ указанный определенный символ указанный

Cкрытые файлы отрабатывают в шаблонах только если в них, точка указана явно.
	\ - экранирование символа

Окружение - набор данных приписанных системой процессу
	a=1 - создает переменную
	$a - позволяет достучаться до нее
	Такая переменная действует только в границах текущего терминала.
		export - позволяет устанавливать системные переменые.
		env - просмотреть переменные окружения
		set - позволяет просмотреть системные переменные
	Запускается по имени только то, что перечисленно в PATH, для всего
	остального нужно явно указывать путь, проще сделать это ./ 
Хорошим тоном будет создание собственного каталога для исполняемых файлов.
LC - переменные локали
PS1 - отвечают за отображения командной строки
	PS1='\t \w' позволяет сменить подсказку на время
		\u - user
		\h - host
		\$ путь

PS2 - подсказки при вводе (пример cat)

скрипты лучше писать на sh тк. они могут быть запущены на любой консоли.

Код возврата после выполнения отработанной программы помещается в переменную
$? 
	0 - успешное завершение
	  или номер ошибки
	  	grep -g - не имеет вывода, но лишь меняет значение переменной 
С помощью этого свойства можно организовывать циклы в зависимости от успешного
исполнения команды.
		test -f -d - производить проверку файлов заданному кретерию
		expr - позволяет считать в консоли
		bc - позволяет считать
Использование индексов параметров $0 $* и тд упрощает обработку параметров
поступающих с командной строки.

Настройка клавишь терминал связанна не только с клавишами но и с программой
readline который настраивается через inputrc
		bind -p -l - позволяет посмотреть все привязки
		tput - позволяет настроить раскладку по терминалам

/etc/profile - основной каталог с переменными окружения для все консолей.
Затем уже обращение идет к домашнему каталогу
.profile выполняется если нет bash_profile в случаее с bash
Далее при работе bash использует bashrc
_____________________________________________________________________________________


	----9. ТЕКСТОВЫЕ РЕДАКТОРЫ ----

РАЗМЕТКА - метаинформация которая может быть написанна в обычном тексте, но должна быть оговорена 
set wrap - установка параметров редактирования
help i - справка по клавише 
Сначала пишем. а потом в командном режиме редактируем.

Пользователь работает с буфером, file~. А потом уже происходит сохранение
файла.

:x - сохранить и выйти

Множитель или повторитель команд 3w

set nomagic

синтаксис поиска и замен воспроизводит sad

Форматирование текса - это использование пробелов, новых строк для лучшего
восприятия текста.

:center
:left
:rigth - позволяют перемещать текст

слово, а затем 	^p предложит автозавершение слова.
		^n тоже-тоже
		^r - повтор действия

Гнездовые команды 
работа со строками текста, крутая штука.
	vimrc - файл конфигурации vim.

emacs-nox - минимальный пакет с emacs 
gvim - нужно компилировать с поддержкой графики

__________________________________________________________________

		      ---10.Этапы загрузки системы-----


	-досистемная 
	-системная загрузка
1) Запуск программы и подпрограмм из ПЗУ (которые еще называются БИОСОМ)
	Опрашивает устройства, проводит первичную диагностику, обращается к
	загрузочному диску, ищет на нем загрузочную запись и передает ей
	управление.
	-первичный загрузчик - расположенный в MBR-секторе, состоит из таблицы
	разделов диска и указывает за загружаемый раздел
	-вторичный загручик - запускается из MBR для старта ОС;

Битовая карта нужна для первоначального загручка, для того чтобы цеплять при
старте необходимые файлы, к примеру модули BTRFS.

Загручик не только запускает ядро, но может и управлять им. Загружать разные
ядра, конфиги и ОС разные.

	LILO - простой загрузчик, может загрузить систему и с диска
	Grub - полуторный загрузчик загружает, вторичный загрузчик, а тот в
	свою очередь обращается к файлу /boot/grub/menu.lst
Grub - позволяет просматривать диски, файлы, находить нужное ядро.
Альтернативность вариантов на каждом этапе загрузки системы.

Ядро системы всегда работает в режиме ядра (супервизора) и никогда не
выгружается из памяти.
Ядро
	-определяет оборудование 
	-запускает процессы ядра (начинаются с [k])
	-монтирует ФС которая указанна в загрузчике Grub, сначало на чтение.
	Если все впорядке то и на запись.
	-запускает /sbin/init процесс с PID 1

Появление модулей ядра, которые должны упростить поддержку оборудования
		lsmod - посмотреть модули
		rmmod - удалить
		insmod - добавить
При загрузке ядро подтягивет указанные модули, так же его можно удалить в
процессе работы.
Образ файловой системы (initrd) необходим ядру для того, чтобы была
возможность циплять модуля.
Ядро и образ упакованны с помощью gzip

init - процесс от которого исходят все другие. Обращается первым делом к своей
конфигурации /etc/inittab где есть: 
	- respawn - ждать завержения действия, так же существуют и другие
	  значения, которые могут определяться и нажатием клавиш.
По этой причине getty ждет завершения login и при этом отсутствует в
процессах.

init запускает getty c параметром respawn. 

Запускаются системные службы в виде демонов.
	Первоначально программы которые нужно было запускать при старте
	системы прописывались в inittab.
Стартовый сценарий - занимается запуск или остановка свойства системы.
должен иметь параметры start, stop сложилось так, что они хранятся в
/etc/init.d
Чтобы не писать путь к файлу можно воспоьзоваться командой service.
Остановка службы может привести к выгрузке модулей.
Использование директории с конфигами, которую подключает процесс.
Cоздать каталог ссылками которые уже будут отвечать за загрузку и порядок
загрузки.
 runlevel - позволяет переключаться в однопользовательский режим, отключить
 графику, сеть и тп.
 	-nonetwork - 
	-single - запускается только одна консоль
	-default3 - без поддержки графики(3)
	-reboot
	-shutdown
			init (номер уровня) - позволяет переключить уровень
initdefault - указывает на уровень по умолчанию
			runlevel - посмотреть текущий загруженный уровень
/etc/runlevels - хранит конфигурации для различных уровней.
	sysinit - запускается до старта уровней. Монтирует систему,
	настраивает аппаратуру.
			HALT, KIll - мягкое прекращение работы процесса.
			reboot -f - жесткое выключение
	shutdown без параметров перейдет на уровень 1, а затем на уровень по
	умолчанию.
_________________________________________________________________


	---11. РАБОТА С ВНЕШНИМИ УСТРОЙСТВАМИ----

В системе есть куча псевдофайлов под возможные устройства, места они не
занимают, зато занимают файловые дескрипторы.

	Использовать файлы-дырки /dev/mouse и отприть в него адрес
	подключенного устройства, для подключения.

		/dev/null - cбросить 
		/dev/zero - cчитать любое количество нулей
		/dev/urandom - cчитать случайные числа
		
			ls -lL - отображать свойства объектов ярлыков
	
Свойства объектов устройств:	
	c - обозначает символьные устройства
	b - блочные устройства
	младший номер устройства 
	старший номер устройства

Каналы и сокеты 
	Каналы создаешь сам mkfifo. Каналы используются в межпроцессорном
	взаимодействии.
	Fifo - системный канал который есть всегда. Каждый канал имеет два
	дескриптора - на чтение и запись
Сокет представляет из себя два канала в обе стороны.

	/etc/modules.conf - конфиг для драйверов.
	depmod - для инициализации

Те. пишишь в файл - отправляешь в сеть, читаешь из него получаешь данные.

Консоль имеет свой файл-дырку. 
У каждого из них есть свои права доступа

login использует chown для присваивания прав на файл терманала пользователю.
Применение групп к устройствам.

Зачем нужно разделять диск?
	Эфективное распределение между задачами
	Возможность работы с разными файловыми системами
	Большая надежность
	Упрощение бэкапа

Таблица разделов диска содержится в записи MBR и состоит из 4 записей.
HDPT - запись содержащая описания extendet разделов. Причем один из
подразделов может быть расширенным.
Она содержится сразу после первого раздела загрузчика.

Файловая система имеет
	системную область
	область данных
Индексный дескриптор - объект в ФС указывающий на расположение файла, его
атрибуты.		
			mount - выводит список подключенных дисков

Разрешить пользователю монтировать только флэшки.
_______________________________________________________________________

		       ---12. КОНФИГУРАЦИОННЫЕ ФАЙЛЫ---


Идея разделить систему на профиль и реализацию.
	-ядро, программы, модули

Профиль - специальная изменяемая часть системы под пользователя.
	-конфигурационные файлы
		-изменение
		-секционность
		-документация

/usr/share/doc - здесь нужно искать документацию
/etc/passwd
/etc/group - хранит инфо о группах
/etc/shadow - может просматривать только root
Здесь можно установить время жизни пароля 
или запретить входить пользователю добавив лишний символ !!

PAM - система аутентификации.

Система журналирования 
Ведение логов обеспечивается за счет функции syslog()
	/var/log/messages - собирает все логи системы.
Прокручивание журнальных файлов. Создает новый файл, а старый архивирует.
__________________________________________________________________________

			      ---13. Пакеты----

Пакет может включать множество программ в себя.
rpm - архивирует содержимое
    - отслеживает зависимости
rpm -qa - список всех пакетов
	-qf - какому пакету принадлежит файл
Изменить конфигурационные файлы, значит иметь их контрольные суммы,
атрибуты и тд.
	-V - проверить, что изменилось в пакете с момента установки
Добавление и удаление псевдопользователя

Пакет включает в себя сценарии установки
	-qi - узнать о составителе пакета
Дистрибьютивы различаются  том, числе различным положением системных файлов

Пакет не может быть удален из системы пока от него зависит другой пакет.

Конфликт - пакет не может быть установлен при наличии другого пакета.

Альтернативы - возможность использовать различные версии пакета, но выбирать
основной через систему ссылок.

Установщик пакетов
Менеджер пакетов - обрабатывает все системные пакеты.

Целостная система - система в которой нет неудовлетворенных зависимостей.
________________________________________________________________________________________
	---Cетевой интерфейс - точка взаимодействия служб и TCP/IP

Настроить сетевой интерфейс - ifconfig
Настроить таблицу маршрутизации - route
/etc/resolve.conf - таблица маршрутизации
		update_chrooted conf - обновляет конфиг chroot

RARP - получить ip по MAC-адресу
BOOTP - при старте получает по ftp конфиг ip, адрес сервера, маршрутизатора, а
также имя файла загрузчика.
DHCP - передает кучу всякой информации

	/etc/ppp - настройка ррр

система iptables управляет службой netfilter



